% Generated by roxygen2 (4.1.0): do not edit by hand
% Please edit documentation in R/functions.R
\name{scde.expression.prior}
\alias{scde.expression.prior}
\title{Estimate prior distribution for gene expression magnitudes}
\usage{
scde.expression.prior(models, counts, length.out = 400, show.plot = F,
  pseudo.count = 1, bw = 0.1, max.quantile = 1 - 0.001,
  max.value = NULL)
}
\arguments{
\item{models}{models determiend by \code{\link{scde.error.models}}}

\item{counts}{count matrix}

\item{length.out}{number of points (resolution) of the expression magnitude grid (default: 400). Note: larger numbers will linearly increase memory/CPU demands.}

\item{show.plot}{show the estimate posterior}

\item{pseudo.count}{pseudo-count value to use (default 1)}

\item{bw}{smoothing bandwidth to use in estimating the prior (default: 0.1)}

\item{max.quantile}{determine the maximum expression magnitude based on a quantile (default : 0.999)}

\item{max.value}{alternatively, specify the exact maximum expression magntiude value}
}
\value{
a structure describing expression magnitude grid ($x, on log10 scale) and prior ($y)
}
\description{
Use existing count data to determine a prior distribution of genes in the dataset
}
\examples{
\donttest{
data(es.mef.small);
cd <- es.mef.small; cd <- cd[rowSums(cd)>0,]; cd <- cd[,colSums(cd)>1e4];
sg <- factor(gsub("(MEF|ESC).*","\\\\1",colnames(cd)),levels=c("ESC","MEF")); names(sg) <- colnames(cd);
o.ifm <- scde.error.models(counts=cd,groups=sg,n.cores=10,threshold.segmentation=T);
o.prior <- scde.expression.prior(models=o.ifm,counts=cd,length.out=400,show.plot=F)
}
}

